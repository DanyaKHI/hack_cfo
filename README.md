# MLnie
## Запуск проекта

1. В файле docker-compose.yml необходимо указать API TOKEN вашего бота:
```
environment:  
  - "API_TOKEN=<ВАШ API_TOKEN>"
```
3. CMD/bash (находясь в корневой директории проекта):
```
docker compose up -d
```
## Структура проекта

main.py - точка входа для телеграмм-бота
database.py - репозиторий для общения с sqlite базой **answers.db**
dispatcher.py - handler сообщений пользователя
/research - директория с jupyter ноутбуками, позволяющими воспроизвести наше решение

## Описание решения

Наша команда разделила решение задачи на несколько этапов:
1. Исследование датасета
	-  Изучение распределения. Мы смогли выявить дизбаланс классов, как по категориям, так и по конкретным классам, что помогло нам разработать решение, учитывающее зависимости количества экземпляров в категории.
	- Обогащение датасета. Наша команда посчитала количество выданных вопросов недостаточным для эффективного обучения, из за чего было принято решение вручную создать дополнительные вопросы, чтобы уточнить детали отношений вопроса-ответа, после чего была использована LLM "GIGACHAT" для обогащения датасета вопросов.
	- Предобработка перед подачей в модель. Так как мы работаем с текстом, мы решили использовать TF-IDF подход для векторизации слов. Стоит отметить, что лучшие результаты мы получали при применение лемматизации к вопросам.
2. Разработка технического решения. Мы исследовали множество комбинаций моделей, но эмпирическим путем остановились на ансамбле моделей, часть которых предсказывает категории объектов, а другая уточняет эти объекты по конкретным классам. Такая архитектура позволяет достичь высоких результатов по f1-micro метрике и хорошо показывает себя на новых вопросах.
